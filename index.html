<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>War Thunder Workout Penalty</title>
    <style>
        :root {
            --primary: #e63946;
            --dark: #121212;
            --light: #f8f9fa;
            --overlay: rgba(0,0,0,0.7);
        }
        
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', sans-serif;
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .bg-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
        }
        
        #bgImage {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }
        
        .bg-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: var(--overlay);
            z-index: -1;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0,0,0,0.5);
            border-radius: 10px;
            backdrop-filter: blur(5px);
        }
        
        .death-input {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .battle-type {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.5);
            padding: 10px;
            border-radius: 5px;
            backdrop-filter: blur(5px);
        }
        
        .battle-option {
            display: flex;
            align-items: center;
            gap: 5px;
            margin: 5px 0;
        }
        
        input, button {
            padding: 10px 15px;
            border-radius: 5px;
            border: none;
        }
        
        input[type="number"] {
            width: 60px;
            text-align: center;
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        button {
            background: var(--primary);
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        button:hover {
            filter: brightness(1.2);
        }
        
        .workout-display {
            background: rgba(0,0,0,0.5);
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(5px);
        }
        
        .exercise {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .exercise-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .exercise-meta {
            display: flex;
            gap: 10px;
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .complete-btn {
            background: #2a9d8f;
            padding: 8px 15px;
            min-width: 80px;
            text-align: center;
        }
        
        /* Radio button styling */
        input[type="radio"] {
            appearance: none;
            width: 16px;
            height: 16px;
            border: 2px solid #ccc;
            border-radius: 50%;
            outline: none;
            transition: all 0.2s;
        }
        
        input[type="radio"]:checked {
            border-color: var(--primary);
            background: var(--primary);
        }
    </style>
</head>
<body>
    <div class="bg-container">
        <img id="bgImage" src="" alt="Background Image">
        <div class="bg-overlay"></div>
    </div>
    
    <div class="container">
        <header>
            <h1>War Thunder Workout Penalty</h1>
            <p>Convert your battles into balanced workouts</p>
        </header>
        
        <div class="battle-type">
            <div class="battle-option">
                <input type="radio" id="airBattles" name="battleType" value="air" checked>
                <label for="airBattles">Air Battles</label>
            </div>
            <div class="battle-option">
                <input type="radio" id="groundBattles" name="battleType" value="ground">
                <label for="groundBattles">Ground Battles</label>
            </div>
        </div>
        
        <div class="death-input">
            <span id="deathText">I died</span>
            <input type="number" id="deathCount" min="1" value="1">
            <span id="deathTextEnd">times without kills</span>
            <button id="generateBtn">Generate Workout</button>
        </div>
        
        <div class="workout-display" id="workoutDisplay">
            <h2>Your Penalty Workout</h2>
            <div id="exercisesList"></div>
        </div>
    </div>

    <script>
        // Background Image Cycling
        const bgImages = [
            "./images/img1.jpg",
            "./images/img2.jpg",
            "./images/img3.jpg"
        ];
        
        const bgImage = document.getElementById("bgImage");
        let bgIndex = parseInt(localStorage.getItem("bgIndex")) || 0;
        
        function cycleBackground() {
            bgImage.src = bgImages[bgIndex];
            bgIndex = (bgIndex + 1) % bgImages.length;
            localStorage.setItem("bgIndex", bgIndex);
        }
        
        // Exercise Database (12 reps default)
        const exerciseDB = {
            arms: [
                { name: "Pushups", equipment: ["bodyweight"], difficulty: 2 },
                { name: "Bicep Curls", equipment: ["dumbbells"], difficulty: 1 },
                { name: "Tricep Dips", equipment: ["bodyweight"], difficulty: 2 }
            ],
            chest: [
                { name: "Bench Press", equipment: ["barbell"], difficulty: 3 },
                { name: "Dumbbell Press", equipment: ["dumbbells"], difficulty: 2 },
                { name: "Pushup Variations", equipment: ["bodyweight"], difficulty: 2 }
            ],
            back: [
                { name: "Pull-ups", equipment: ["bodyweight"], difficulty: 3 },
                { name: "Bent Over Rows", equipment: ["dumbbells"], difficulty: 2 },
                { name: "Reverse Flyes", equipment: ["dumbbells"], difficulty: 2 }
            ],
            abs: [
                { name: "Russian Twists", equipment: ["bodyweight"], difficulty: 2 },
                { name: "Leg Raises", equipment: ["bodyweight"], difficulty: 2 },
                { name: "Plank", equipment: ["bodyweight"], difficulty: 1 }
            ],
            legs: [
                { name: "Squats", equipment: ["bodyweight"], difficulty: 2 },
                { name: "Lunges", equipment: ["bodyweight"], difficulty: 2 },
                { name: "Calf Raises", equipment: ["bodyweight"], difficulty: 1 }
            ]
        };

        // Muscle group rotation order
        const muscleRotation = ["arms", "chest", "back", "abs", "legs"];
        
        // User State
        const userState = {
            deaths: 0,
            equipment: ["bodyweight"],
            battleType: "air", // Default to air battles
            workoutHistory: JSON.parse(localStorage.getItem("workoutHistory")) || {
                arms: { count: 0, lastDone: null },
                chest: { count: 0, lastDone: null },
                back: { count: 0, lastDone: null },
                abs: { count: 0, lastDone: null },
                legs: { count: 0, lastDone: null }
            }
        };

        // DOM Elements
        const deathCountInput = document.getElementById("deathCount");
        const generateBtn = document.getElementById("generateBtn");
        const exercisesListEl = document.getElementById("exercisesList");
        const deathTextEl = document.getElementById("deathText");
        const deathTextEndEl = document.getElementById("deathTextEnd");
        const airBattlesRadio = document.getElementById("airBattles");
        const groundBattlesRadio = document.getElementById("groundBattles");

        // Update death text based on battle type
        function updateDeathText() {
            if (userState.battleType === "air") {
                deathTextEl.textContent = "I died";
                deathTextEndEl.textContent = "times without kills";
            } else {
                deathTextEl.textContent = "I lost";
                deathTextEndEl.textContent = "games";
            }
        }

        // Get least worked muscle groups
        function getPriorityMuscles() {
            return [...muscleRotation].sort((a, b) => {
                return userState.workoutHistory[a].count - userState.workoutHistory[b].count || 
                       new Date(userState.workoutHistory[a].lastDone || 0) - new Date(userState.workoutHistory[b].lastDone || 0);
            });
        }

        // Generate balanced workout
        function generateWorkout() {
            const deaths = parseInt(deathCountInput.value) || 1;
            userState.deaths = deaths;
            
            exercisesListEl.innerHTML = "";
            
            const priorityMuscles = getPriorityMuscles();
            const selectedExercises = [];
            
            // Distribute exercises based on death count
            for (let i = 0; i < deaths; i++) {
                const muscleIndex = i % priorityMuscles.length;
                const muscle = priorityMuscles[muscleIndex];
                
                const availableExercises = exerciseDB[muscle].filter(ex => 
                    ex.equipment.some(e => userState.equipment.includes(e))
                );
                
                if (availableExercises.length > 0) {
                    const exercise = availableExercises[Math.floor(Math.random() * availableExercises.length)];
                    selectedExercises.push({
                        ...exercise,
                        muscleGroup: muscle,
                        reps: 12 // Default reps
                    });
                    
                    // Update history
                    userState.workoutHistory[muscle].count++;
                    userState.workoutHistory[muscle].lastDone = new Date().toISOString();
                }
            }
            
            // Save data
            localStorage.setItem("workoutHistory", JSON.stringify(userState.workoutHistory));
            localStorage.setItem("battleType", userState.battleType);
            
            // Display workout
            selectedExercises.forEach((ex, index) => {
                const exerciseEl = document.createElement("div");
                exerciseEl.className = "exercise";
                
                exerciseEl.innerHTML = `
                    <div class="exercise-info">
                        <h3>${ex.name} (${ex.reps} reps)</h3>
                        <div class="exercise-meta">
                            <span>${ex.muscleGroup}</span>
                            <span>${"★".repeat(ex.difficulty)}</span>
                        </div>
                    </div>
                    <button class="complete-btn">Complete</button>
                `;
                
                exerciseEl.querySelector(".complete-btn").addEventListener("click", () => {
                    exerciseEl.style.opacity = "0.5";
                    exerciseEl.querySelector(".complete-btn").textContent = "✓ Done";
                    setTimeout(() => exerciseEl.remove(), 1000);
                });
                
                exercisesListEl.appendChild(exerciseEl);
            });
            
            cycleBackground();
        }

        // Event Listeners
        generateBtn.addEventListener("click", generateWorkout);
        
        airBattlesRadio.addEventListener("change", () => {
            if (airBattlesRadio.checked) {
                userState.battleType = "air";
                updateDeathText();
            }
        });
        
        groundBattlesRadio.addEventListener("change", () => {
            if (groundBattlesRadio.checked) {
                userState.battleType = "ground";
                updateDeathText();
            }
        });

        // Initialize
        const savedBattleType = localStorage.getItem("battleType");
        if (savedBattleType) {
            userState.battleType = savedBattleType;
            if (savedBattleType === "air") {
                airBattlesRadio.checked = true;
            } else {
                groundBattlesRadio.checked = true;
            }
        }
        
        updateDeathText();
        cycleBackground();
    </script>
</body>
</html>
